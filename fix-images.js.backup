const fs = require('fs');
const path = require('path');

// Function to sanitize filename
function sanitizeFilename(filename) {
  return filename
    .replace(/WhatsApp Image /g, '')
    .replace(/\s+/g, '-')
    .replace(/[()]/g, '')
    .replace(/-+/g, '-')
    .replace(/^-|-$/g, '')
    .toLowerCase();
}

// Function to rename files in directory
function renameFilesInDir(dirPath, prefix = '') {
  if (!fs.existsSync(dirPath)) {
    console.log(`Directory not found: ${dirPath}`);
    return;
  }

  const files = fs.readdirSync(dirPath);
  const imageFiles = files.filter(file => /\.(jpg|jpeg|png|gif|webp)$/i.test(file));
  
  console.log(`\nProcessing ${dirPath}:`);
  
  imageFiles.forEach((file, index) => {
    const oldPath = path.join(dirPath, file);
    const ext = path.extname(file);
    let newName;
    
    if (file.startsWith('WhatsApp Image')) {
      newName = `${prefix}${index + 1}${ext}`;
    } else if (file.includes(' ') || file.includes('(') || file.includes(')')) {
      newName = sanitizeFilename(file);
    } else {
      return; // Skip files that are already fine
    }
    
    const newPath = path.join(dirPath, newName);
    
    try {
      fs.renameSync(oldPath, newPath);
      console.log(`  ${file} -> ${newName}`);
    } catch (error) {
      console.error(`  Error renaming ${file}: ${error.message}`);
    }
  });
}

// Main execution
console.log('Starting image renaming process...');

// Rename files in each directory
renameFilesInDir('public/images/Hero sections', 'hero-');
renameFilesInDir('public/images/About', 'about-');
renameFilesInDir('public/images/Books', 'book-');
renameFilesInDir('public/images/Gallery', 'gallery-');
renameFilesInDir('public/images/Newspapers', 'news-');

console.log('\nImage renaming completed!');
